---
import LucideIcon from './icons/LucideIcon';
import { APP_URLS } from '../config/env';
---

<nav class="fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-md border-b border-[var(--border-subtle-color)] transition-all duration-300" id="navbar">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="flex justify-between items-center h-20">
			<!-- Logo -->
			<a href="/" class="flex items-center space-x-3 group" aria-label="Inicio">
				<img 
					src="/logo.png" 
					alt="Clínica Veterinaria Logo" 
					class="h-12 w-12 rounded-full object-cover transition-transform duration-300 group-hover:scale-105"
					width="48"
					height="48"
				/>
			</a>

			<!-- Desktop Navigation -->
			<div class="hidden md:flex items-center space-x-1">
				<a href="#inicio" class="px-4 py-2 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] font-medium transition-colors duration-200 rounded-lg hover:bg-[var(--color-surface-200)]">
					Inicio
				</a>
				<a href="#servicios" class="px-4 py-2 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] font-medium transition-colors duration-200 rounded-lg hover:bg-[var(--color-surface-200)]">
					Servicios
				</a>
				<a href="#nosotros" class="px-4 py-2 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] font-medium transition-colors duration-200 rounded-lg hover:bg-[var(--color-surface-200)]">
					Nosotros
				</a>
				<a href="#testimonios" class="px-4 py-2 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] font-medium transition-colors duration-200 rounded-lg hover:bg-[var(--color-surface-200)]">
					Testimonios
				</a>
				<a href="#contacto" class="px-4 py-2 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] font-medium transition-colors duration-200 rounded-lg hover:bg-[var(--color-surface-200)]">
					Contacto
				</a>
			</div>

			<!-- CTA Button -->
			<div class="hidden md:flex items-center space-x-4">
				<a 
					href={APP_URLS.AGENDAR_CITA} 
					class="px-6 py-2.5 bg-[var(--color-primary)] hover:bg-[var(--color-primary-dark)] text-white rounded-xl font-semibold transition-all duration-300 shadow-[var(--shadow-primary)] hover:shadow-[var(--shadow-medium)] hover:scale-[1.02]"
				>
					Agendar Cita
				</a>
				<a 
					href={APP_URLS.INGRESAR} 
					class="px-6 py-2.5 border border-[var(--color-primary)]/30 hover:border-[var(--color-primary)] hover:bg-[var(--color-surface-200)] text-[var(--color-text-primary)] rounded-xl font-semibold transition-all duration-300"
				>
					Ingresar
				</a>
			</div>

			<!-- Mobile Menu Button -->
			<button
				id="mobile-menu-button"
				class="md:hidden p-1.5 rounded-lg text-[var(--color-text-primary)] hover:bg-[var(--color-surface-200)] transition-colors duration-200 relative cursor-pointer"
				aria-label="Toggle menu"
			>
				<span id="menu-icon-wrapper">
					<LucideIcon name="Menu" id="menu-icon" class="w-5 h-5" client:load />
				</span>
				<span id="close-icon-wrapper" class="hidden">
					<LucideIcon name="X" id="close-icon" class="w-5 h-5" client:load />
				</span>
			</button>
		</div>

		<!-- Mobile Navigation -->
		<div id="mobile-menu" class="hidden md:hidden pb-4 border-t border-[var(--border-subtle-color)] mt-2">
			<div class="flex flex-col space-y-2 pt-4">
				<a href="#inicio" class="px-4 py-2.5 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] hover:bg-[var(--color-surface-200)] rounded-lg font-medium transition-colors duration-200">
					Inicio
				</a>
				<a href="#servicios" class="px-4 py-2.5 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] hover:bg-[var(--color-surface-200)] rounded-lg font-medium transition-colors duration-200">
					Servicios
				</a>
				<a href="#nosotros" class="px-4 py-2.5 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] hover:bg-[var(--color-surface-200)] rounded-lg font-medium transition-colors duration-200">
					Nosotros
				</a>
				<a href="#testimonios" class="px-4 py-2.5 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] hover:bg-[var(--color-surface-200)] rounded-lg font-medium transition-colors duration-200">
					Testimonios
				</a>
				<a href="#contacto" class="px-4 py-2.5 text-[var(--color-text-secondary)] hover:text-[var(--color-primary)] hover:bg-[var(--color-surface-200)] rounded-lg font-medium transition-colors duration-200">
					Contacto
				</a>
				<div class="flex flex-col space-y-2 pt-2 border-t border-[var(--border-subtle-color)]">
					<a href={APP_URLS.AGENDAR_CITA} class="px-4 py-2.5 bg-[var(--color-primary)] text-white rounded-xl font-semibold text-center transition-all duration-300 shadow-[var(--shadow-primary)]">
						Agendar Cita
					</a>
					<a href={APP_URLS.INGRESAR} class="px-4 py-2.5 border border-[var(--color-primary)]/30 text-[var(--color-text-primary)] rounded-xl font-semibold text-center transition-all duration-300">
						Ingresar
					</a>
				</div>
			</div>
		</div>
	</div>
</nav>

<script>
	function initMobileMenu() {
		const mobileMenuButton = document.getElementById('mobile-menu-button');
		const mobileMenu = document.getElementById('mobile-menu');
		const menuIconWrapper = document.getElementById('menu-icon-wrapper');
		const closeIconWrapper = document.getElementById('close-icon-wrapper');
		const navbar = document.getElementById('navbar');

		function closeMenu() {
			if (mobileMenu && menuIconWrapper && closeIconWrapper) {
				mobileMenu.classList.add('hidden');
				menuIconWrapper.classList.remove('hidden');
				closeIconWrapper.classList.add('hidden');
			}
		}

		function openMenu() {
			if (mobileMenu && menuIconWrapper && closeIconWrapper) {
				mobileMenu.classList.remove('hidden');
				menuIconWrapper.classList.add('hidden');
				closeIconWrapper.classList.remove('hidden');
			}
		}

		if (mobileMenuButton && mobileMenu && menuIconWrapper && closeIconWrapper) {
			// Toggle del menú al hacer clic en el botón
			mobileMenuButton.addEventListener('click', (e) => {
				e.stopPropagation();
				const isHidden = mobileMenu.classList.contains('hidden');
				
				if (isHidden) {
					openMenu();
				} else {
					closeMenu();
				}
			});

			// Cerrar menú al hacer clic fuera del navbar
			document.addEventListener('click', (e) => {
				const target = e.target as Node;
				if (navbar && !navbar.contains(target) && !mobileMenu.classList.contains('hidden')) {
					closeMenu();
				}
			});

			// Cerrar menú al hacer clic en un enlace
			const mobileLinks = mobileMenu.querySelectorAll('a');
			mobileLinks.forEach(link => {
				link.addEventListener('click', () => {
					closeMenu();
				});
			});
		}
	}

	// Esperar a que el DOM esté listo
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initMobileMenu);
	} else {
		// Si ya está cargado, ejecutar inmediatamente
		setTimeout(initMobileMenu, 100);
	}
</script>
